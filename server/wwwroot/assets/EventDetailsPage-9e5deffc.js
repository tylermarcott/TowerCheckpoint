import{j as b,A as a,T as A,_ as S,k as B,u as L,w as P,b as V,e as h,P as r,f as d,m as j,r as F,o as s,c as i,a as t,n as v,F as w,g as E,t as k,q as D,s as N,v as x,x as R,y as M,h as U}from"./index-eddf7603.js";class q{async createTicket(n){const m=await b.post("api/tickets",n);a.activeEventTickets.push(new A(m.data))}async deleteTicket(n){await b.delete(`api/tickets/${n}`);const m=a.activeEventTickets.findIndex(e=>e.id==n);a.activeEventTickets.splice(m,1)}}const I=new q;const J={setup(){const l=B({}),n=L();P(()=>{m(),u(),e()}),V(()=>e());async function m(){try{await h.getEventById(n.params.eventId)}catch(c){r.error(c)}}async function e(){try{await h.getCommentsByEventId(n.params.eventId)}catch(c){r.error(c)}}async function u(){try{await h.getTicketsByEventId(n.params.eventId)}catch(c){r.error(c)}}return{commentData:l,ticketTotal:d(()=>a.activeEvent.capacity-a.activeEvent.ticketCount),event:d(()=>a.activeEvent),user:d(()=>a.user),account:d(()=>a.account),tickets:d(()=>a.activeEventTickets),comments:d(()=>a.activeComments),isAttending:d(()=>a.activeEventTickets.find(c=>c.accountId==a.account.id)),async cancelEvent(){try{return await h.cancelEvent(a.activeEvent.id)}catch(c){r.error(c)}},async createComment(){try{l.value.eventId=n.params.eventId,await j.createComment(l.value),r.toast("Comment created","success")}catch(c){r.error(c)}},async createTicket(){try{let c={eventId:n.params.eventId};await I.createTicket(c),a.activeEvent.capacity--}catch(c){r.error(c)}},async deleteTicket(){try{let c=a.activeEventTickets.find(_=>_.accountId==a.account.id);await I.deleteTicket(c.id),a.activeEvent.capacity++}catch(c){r.error(c)}},dateFormat(c){return new Date(c).toLocaleDateString("en-us",{month:"long",day:"numeric"})},timeFormat(c){return new Date(c).toLocaleTimeString("en-us",{hour:"numeric",minute:"2-digit"})}}}},z={key:0,class:"container"},K={class:"row justify-content-center mb-5"},O={class:"col-12 col-md-8 d-flex justify-content-center elevation-2 img-background"},Q={key:0,class:"img",src:"https://media.istockphoto.com/id/1278420063/vector/cancel-red-ink-stamp.jpg?s=612x612&w=0&k=20&c=ElHKDdD9UnVxJqDLezLRJ7zhRC-hJVdvEFCsnJ9lNb0=",alt:""},X={key:1,class:"img",src:"https://media.istockphoto.com/id/1019461088/vector/sold-out-red-square-grunge-stamp-on-white.jpg?s=612x612&w=0&k=20&c=Q1funtaP0CzqKKU_Okp6QQXGP79-X_cNAYd7trlR5-s=",alt:""},G=["src","alt"],H=t("div",null," change test ",-1),Y={class:"col-12 ticketholder-card elevation-2"},W=t("h5",null,"Ticketholders:",-1),Z={class:"row"},$={class:"col-12"},ee=["title","src","alt"],te=t("img",null,null,-1),ne={class:"row justify-content-center"},ce={class:"col-12 col-md-10 details-card elevation-2 bg-light"},oe={class:"row text-center m-2"},ae={class:"row text-center m-2"},se={class:"row text-center m-2"},ie={class:"col-12"},re={class:"row mt-5 ms-2"},le={class:"col-6"},de={class:"col-12 col-md-6 text-center p-2"},me=t("i",{class:"mdi mdi-plus"},null,-1),ve=t("i",{class:"mdi mdi-minus"},null,-1),_e={key:2,class:"btn btn-dark"},ke={key:3},he={key:5},ue={class:"row"},ye={class:"mb-3"},ge=t("label",{for:"commentData-body",class:"form-label"},"Comment",-1),fe={class:"form-check mb-3"},Te=t("label",{class:"form-check-label",for:"flexCheckDefault"}," Attending event? ",-1),Ce=t("button",{class:"btn btn-dark"},"Submit",-1),be={class:"row justify-content-center"};function we(l,n,m,e,u,c){var y,g,f,T,C;const _=F("CommentCard");return e.event?(s(),i("section",z,[t("div",K,[t("div",O,[e.event.isCanceled?(s(),i("img",Q)):e.event.capacity-e.event.ticketCount==0?(s(),i("img",X)):v("",!0),e.event.isCanceled||e.event.capacity-e.event.ticketCount==0?v("",!0):(s(),i("img",{key:2,class:"img",src:e.event.coverImg,alt:e.event.name},null,8,G))])]),H,t("div",Y,[W,t("div",Z,[t("div",$,[(s(!0),i(w,null,E(e.tickets,o=>(s(),i("img",{onMouseover:n[0]||(n[0]=(...p)=>l.name&&l.name(...p)),title:o.profile.name,class:"profile-img",key:o.id,src:o.profile.picture,alt:o.profile.name},null,40,ee))),128)),te])])]),t("div",ne,[t("div",ce,[t("div",oe,[t("h3",null,k(e.event.name),1)]),t("div",ae,[t("h5",null,k(e.event.location)+", "+k(e.dateFormat(e.event.startDate)),1)]),t("div",se,[t("div",ie,[t("p",null,k(e.event.description),1)])]),t("div",re,[t("div",le,[t("h5",null,"Tickets Left: "+k(e.event.capacity-e.event.ticketCount),1)]),t("div",de,[e.user.isAuthenticated&&!e.isAttending&&e.ticketTotal!=0&&!((y=e.event)!=null&&y.isCanceled)?(s(),i("button",{key:0,onClick:n[1]||(n[1]=(...o)=>e.createTicket&&e.createTicket(...o)),class:"btn btn-warning m-1"},[me,D(" Purchase Ticket")])):e.user.isAuthenticated&&!((g=e.event)!=null&&g.isCanceled)&&e.isAttending?(s(),i("button",{key:1,onClick:n[2]||(n[2]=(...o)=>e.deleteTicket&&e.deleteTicket(...o)),role:"button",class:"btn btn-danger m-1"},[ve,D(" Return Ticket")])):!e.user.isAuthenticated&&!e.event.isCanceled?(s(),i("button",_e,"Please Log in to purchase or return tickets!")):v("",!0),e.ticketTotal==0?(s(),i("h3",ke,"SOLD OUT")):v("",!0),((f=e.event)==null?void 0:f.creatorId)==e.account.id&&!((T=e.event)!=null&&T.isCanceled)&&e.ticketTotal!=0?(s(),i("button",{key:4,onClick:n[3]||(n[3]=(...o)=>e.cancelEvent&&e.cancelEvent(...o)),class:"btn btn-danger m-1"},"Cancel Event")):(C=e.event)!=null&&C.isCanceled&&e.ticketTotal!=0?(s(),i("h3",he,"Event Canceled")):v("",!0)])])])]),t("section",ue,[t("form",{class:"my-2 create-comment-card elevation-2 p-2 col-12",onSubmit:n[6]||(n[6]=N((...o)=>e.createComment&&e.createComment(...o),["prevent"]))},[t("div",ye,[ge,x(t("textarea",{"onUpdate:modelValue":n[4]||(n[4]=o=>e.commentData.body=o),class:"form-control",id:"comment-body",rows:"6"},null,512),[[R,e.commentData.body]])]),t("div",fe,[x(t("input",{"onUpdate:modelValue":n[5]||(n[5]=o=>e.commentData.isAttending=o),class:"form-check-input",type:"checkbox",value:"",id:"comment-isAttending"},null,512),[[M,e.commentData.isAttending]]),Te]),Ce],32)]),t("section",be,[(s(!0),i(w,null,E(e.comments,o=>(s(),i("div",{key:o.id,class:"col-12 col-md-10 elevation-2 m-2 p-2 create-comment-card"},[U(_,{comment:o},null,8,["comment"])]))),128))])])):v("",!0)}const De=S(J,[["render",we]]);export{De as default};
